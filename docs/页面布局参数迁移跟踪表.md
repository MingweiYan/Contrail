# 页面布局参数迁移跟踪表

本文档用于跟踪Contrail应用中所有页面布局参数迁移到`page_layout_constants.dart`的进度，确保有序、完整地完成迁移工作。

## 迁移状态说明
- **未开始**：尚未开始迁移
- **进行中**：正在进行迁移工作
- **已完成**：迁移已完成并通过验证
- **已验证**：迁移完成且通过视觉比对验证

## 页面迁移状态表

### 习惯模块页面

| 页面名称 | 文件路径 | 常量类名称 | 迁移状态 | 迁移日期 | 负责人 | 备注 |
|---------|---------|-----------|---------|---------|-------|------|
| 添加习惯页面 | lib/features/habit/presentation/pages/add_habit_page.dart | AddHabitPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，共36处ScreenUtil调用已替换，布局验证通过 |
| 习惯管理页面 | lib/features/habit/presentation/pages/habit_management_page.dart | HabitManagementPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，共12处ScreenUtil调用已替换，布局验证通过 |
| 全屏时钟页面 | lib/features/habit/presentation/pages/fullscreen_clock_page.dart | FullscreenClockPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，共3处ScreenUtil调用已替换，布局验证通过 |
| 图标选择器页面 | lib/features/habit/presentation/pages/icon_selector_page.dart | IconSelectorPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，共12处ScreenUtil调用已替换，布局验证通过 |
| 习惯追踪页面 | lib/features/habit/presentation/pages/habit_tracking_page.dart | HabitTrackingPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，共34处ScreenUtil调用已替换，布局验证通过 |
| 全屏编辑器页面 | lib/features/habit/presentation/pages/full_editor_page.dart | FullEditorPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，共2处ScreenUtil调用已替换，布局验证通过 |

### 统计模块页面

| 页面名称 | 文件路径 | 常量类名称 | 迁移状态 | 迁移日期 | 负责人 | 备注 |
|---------|---------|-----------|---------|---------|-------|------|
| 统计页面 | lib/features/statistics/presentation/pages/statistics_page.dart | StatisticsPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，共6处ScreenUtil调用已替换，布局验证通过 |
| 习惯详情统计页面 | lib/features/statistics/presentation/pages/habit_detail_statistics_page.dart | HabitDetailStatisticsPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，约35处ScreenUtil调用已替换，布局验证通过 |
| 统计分享结果页面 | lib/features/statistics/presentation/pages/stats_share_result_page.dart | StatsShareResultPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |

### 个人资料模块页面

| 页面名称 | 文件路径 | 常量类名称 | 迁移状态 | 迁移日期 | 负责人 | 备注 |
|---------|---------|-----------|---------|---------|-------|------|
| 个人资料页面 | lib/features/profile/presentation/pages/profile_page.dart | ProfilePageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |
| 数据备份页面 | lib/features/profile/presentation/pages/data_backup_page.dart | DataBackupPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，共18处ScreenUtil调用已替换，布局验证通过 |
| 主题选择页面 | lib/features/profile/presentation/pages/theme_selection_page.dart | ThemeSelectionPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |
| 个性化设置页面 | lib/features/profile/presentation/pages/personalization_settings_page.dart | PersonalizationSettingsPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |

### 共享页面

| 页面名称 | 文件路径 | 常量类名称 | 迁移状态 | 迁移日期 | 负责人 | 备注 |
|---------|---------|-----------|---------|---------|-------|------|
| JSON编辑器页面 | lib/shared/utils/json_editor_page.dart | JsonEditorPageConstants | 已完成 | 2025-11-11 | - | 已完成迁移，共8处ScreenUtil调用已替换，布局验证通过 |

## 组件迁移状态表

### 习惯模块组件

| 组件名称 | 文件路径 | 常量类名称 | 迁移状态 | 迁移日期 | 负责人 | 备注 |
|---------|---------|-----------|---------|---------|-------|------|
| 习惯项组件 | lib/features/habit/presentation/widgets/habit_item_widget.dart | HabitItemWidgetConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |
| 番茄钟设置对话框 | lib/features/habit/presentation/widgets/pomodoro_settings_dialog.dart | PomodoroSettingsDialogConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |
| 补充打卡对话框 | lib/features/habit/presentation/widgets/supplement_check_in_dialog.dart | SupplementCheckInDialogConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |

### 统计模块组件

| 组件名称 | 文件路径 | 常量类名称 | 迁移状态 | 迁移日期 | 负责人 | 备注 |
|---------|---------|-----------|---------|---------|-------|------|
| 统计图表组件 | lib/features/statistics/presentation/widgets/statistics_chart_widget.dart | StatisticsChartWidgetConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |
| 统计详情视图 | lib/features/statistics/presentation/widgets/statistics_detail_view.dart | StatisticsDetailViewConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |
| 时间轴视图 | lib/features/statistics/presentation/widgets/timeline_view_widget.dart | TimelineViewWidgetConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |

### 个人资料模块组件

| 组件名称 | 文件路径 | 常量类名称 | 迁移状态 | 迁移日期 | 负责人 | 备注 |
|---------|---------|-----------|---------|---------|-------|------|
| 备份恢复确认对话框 | lib/features/profile/presentation/widgets/backup_restore_confirmation_dialog.dart | BackupRestoreConfirmationDialogConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |
| 备份删除确认对话框 | lib/features/profile/presentation/widgets/backup_delete_confirmation_dialog.dart | BackupDeleteConfirmationDialogConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |

### 共享组件

| 组件名称 | 文件路径 | 常量类名称 | 迁移状态 | 迁移日期 | 负责人 | 备注 |
|---------|---------|-----------|---------|---------|-------|------|
| 头部卡片组件 | lib/shared/widgets/header_card_widget.dart | HeaderCardWidgetConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |
| 时钟组件 | lib/shared/widgets/clock_widget.dart | ClockWidgetConstants | 已完成 | 2025-11-11 | - | 已完成迁移，所有ScreenUtil调用已替换为常量类引用 |

## 迁移步骤说明

1. **准备阶段**
   - 从跟踪表中选择一个页面/组件
   - 确保对应的常量类已在`page_layout_constants.dart`中定义

2. **迁移阶段**
   - 在目标文件顶部导入常量类：`import 'package:contrail/shared/utils/page_layout_constants.dart';`
   - 将文件中的`ScreenUtil().setWidth()`, `ScreenUtil().setHeight()`, `ScreenUtil().setSp()`调用替换为常量类中的对应值
   - 保持原始值不变，确保布局一致性
   - 移除不再需要的ScreenUtil导入

3. **验证阶段**
   - 运行应用，查看页面布局是否与迁移前一致
   - 进行视觉比对，确保没有布局异常
   - 测试页面交互功能

4. **完成阶段**
   - 更新迁移跟踪表中的状态
   - 记录迁移日期和相关信息
   - 创建迁移日志文件
   - 提交代码修改

## 迁移日志目录

为每个页面/组件创建单独的迁移日志文件，存放在以下目录：

- [迁移日志目录](./迁移日志/)

## 常见问题与解决方案

### 1. 常量名称与实际需求不匹配
- **解决方案**：在常量类中添加缺失的常量，保持命名规范
- **责任人**：当前迁移任务负责人
- **验证方式**：确保新常量被正确使用且布局不变

### 2. 布局在迁移后出现变化
- **解决方案**：检查常量值是否与原始值完全一致，使用精确的数值匹配
- **责任人**：当前迁移任务负责人
- **验证方式**：与迁移前的截图进行比对

### 3. 复杂的布局参数计算
- **解决方案**：在常量类中预计算复杂值，避免在页面中进行计算
- **责任人**：当前迁移任务负责人
- **验证方式**：确保计算结果与原始行为一致

### 4. 常量类引用错误
- **解决方案**：检查导入语句和常量类名称是否正确
- **责任人**：当前迁移任务负责人
- **验证方式**：确保代码可以正常编译和运行

## 进度报告

### 总体进度统计

| 类别 | 总数 | 未开始 | 进行中 | 已完成 | 已验证 | 完成率 |
|------|------|--------|--------|--------|--------|--------|
| 页面 | 13 | 0 | 0 | 13 | 0 | 100% |
| 组件 | 9 | 0 | 0 | 9 | 0 | 100% |
| **总计** | **22** | **0** | **0** | **22** | **0** | **100%** |

### 模块进度统计

| 模块 | 总数 | 进行中 | 已完成 | 完成率 |
|------|------|--------|--------|--------|
| 习惯模块 | 9 | 0 | 9 | 100% |
| 统计模块 | 6 | 0 | 6 | 100% |
| 个人资料模块 | 6 | 0 | 6 | 100% |
| 共享组件/页面 | 1 | 0 | 1 | 100% |

### 每周进度更新

| 日期 | 本周完成页面数 | 本周进行中页面数 | 累计完成数 | 累计完成率 | 备注 |
|------|--------------|--------------|------------|------------|------|
| 2025-11-11 | 13 | 0 | 13 | 100% | 所有页面（全屏时钟页面、数据备份页面、JSON编辑器页面、习惯管理页面、添加习惯页面、图标选择器页面、习惯追踪页面、全屏编辑器页面、统计页面、习惯详情统计页面、统计分享结果页面、个人资料页面和主题选择页面）均已完成迁移 |
| 2025-11-18 | 0 | 0 | 0 | 9.09% | - |
| 2025-11-25 | 0 | 0 | 0 | 9.09% | - |
| 2025-12-02 | 0 | 0 | 0 | 9.09% | - |
| 2025-12-09 | 0 | 0 | 0 | 9.09% | - |
| 2025-12-16 | 0 | 0 | 0 | 9.09% | - |
| 2025-12-23 | 0 | 0 | 0 | 9.09% | - |

## 注意事项

1. 每次迁移完成后必须更新此跟踪表
2. 确保迁移前后页面布局完全一致
3. 遵循命名规范和组织规范
4. 记录详细的迁移日志
5. 定期进行代码审查确保质量
6. 遇到问题及时在备注栏记录并寻求帮助